Échange de clé de Diffie-Hellmann :
'''
keyLength est la longueur des exposants
'''
keyLength = 224
'''
p est un nombre premier de taille 2048 bits !
'''
'''
Prime p
'''
p=24614092481603675731022075504383970335861830446883656936098962383938382597155724410430243530965542885322619768354894043222329205609960639841580709735495389909590288527350912074671010178922728935676009317789070638187521776854607144456305976038124908544106052201710087045521190032822578138524094178173865986609218076580978974752369483329590199684056900183812362804154774158997198985445429752558493132015856469411654748592885301239734605491604776596101592931244982321392477545745244182551892125483837624577120046170422115391937038862227491891494491839783639103206553554356553358497274651923633629920203269526755664925609
p=0xc2fb2dffb8ce15ecd34167db630b5089e5af87e10ba71a8844933d4295d991e759ca7a87f1405f0b13eeb9fd5ac3406d8e2ae494e4a1a593acfba07bdadf9907f0d5769396a6c31d2f65bbdaf763d15c83a84da0ec9c249e3f6eb4974f8037889d583e508a14c941dd46136f82acb0b3e6633788dd3cd8cbe295a173a16617d698a2c79373308b727ab8bfd19658fc97589addf1289293d1f8602dbcfd995fd581c69bdc4d343666d23d21cb39f2d144a78d0990c10fc68329b1ff7cf53064324819a68c3fff20d366747f28e2fc352b2986a20cb78dca4b5235022b91656f7541b41a4c72ef6d4a4e4dbd349ac4624ff89ca8ad5b690ec53c8b7acec92b13a9
'''
Generator of subgroup of order prime q
'''
q=37857528232712378897038098931233501862187182862283535690692830454097
q=0x1677a8da84cdd652c3ff116bf1aee67292fa57270599f4489e7f06151
g=14789793378077042242120521274037173391261010897636027265546123991563081831117275602982548761034024939845068354539610331532179872637433915394357888709248768667015051009766903635340070489131469049935363547607412057386342667716086793042541140822036624962204941306851549581646548063457001829647969667092583879328471840523390686750127027177781732963459386987665454322343126115917897936842728751365823011567834334210685873039530186907858035417612336029663247537873925629446028254962335530541433683915420633067884365208203268094633097771062061842251521566768365548727309890441197387119672931485366288879688731042699119144292
g=0x7528610f7387cfbcce88890800a44b79126f8468c401c8af809ab9b52d98ae7c2d8a25e9685c75d16a5eb20ac74b0ba5d40c5946d6d91698a6a47289a18096bebb5c0961831180bc831fe5da3c1d815d139defee55f287607db59a3e43b1652de57b86e481de41b4d2d250ee10931078f6dddbbcf6203d961c4b6e251e3ce8fcc9d42b65be1b6e397c70e805fb0cc71c633efd6c1c4d925cf3af26c21579976122493b9a8f5e632138114c6a93e9d8efc2cefd500bfa74626ac1772b2f413994da8276fc96463de28f20965dfcd4e0a27de4085748dda6d8b94d5f0fc9303f2ffd404c6af439f62b76a04254465ed6106b9e1f5112fca3a3bc6d1cc180c3ad64
'''
kpub_bob = g^k_bob mod p est la valeur reçue de Bob par Alice, e est l'exposant secret d'Alice
=> kpub_bob^k_alice mod p est donc la clé secrète partagée par Bob et Alice (Diffie Hellmann)
'''
kpub_bob=252239457474958630323587649045614330980454087958089912758321883097065199357012062435821061381302557994141635072505756697173021187014787421454581918982207576837250118591551044991118887437086949356274491383941570368025954469594549027397234677904485857955263227197003914644204898782555235259911490478613264643658581103118217743952922107042947593787435920882024938302871457082327241385815991148938988604347366502729389825202009422332357125151492081509759455308286993938956060533809328214598166969120779878536514116683282303638897632188692694483356969065533381327985880765560045988044692050472124712362603327613010909741
kpub_bob=0x1ff84e22a60b32a9d2f999e67292ca7d2c3ccb84f34be3bee7acb063191ff99e993a9d582e4a209114d138ce770562cc85647a80f9938442a4503a08b0527f06d953b20b3c431c01b7f1968ef1f451fc9c590810678e78b5307165388b0c9f15baa6e2521db3522e000984feb04d512f650cb81c31f51a2cd493dd3a4f2f35d2dfc6e024c53a57a1c15cd9558d18f8fdb43fc152e54deb0b2c33b62283ddbf9ac7f9c7a6355cc76b54f396de7dbd3da2af5f6615c9677244b9e1a9c4bf62e99720a5f041dfb3e8915afc5b9402e0560d5cb109e95e2f735d71d7c768ce3b8aae4dba9839ab39c43cb7113790714a522bc20f0ecbbb807a7d5469e90951b1a2d
'''
Algorithme de calcul : Right-to-Left-Square-and-Multiply
complexité : t carrés et en moyenne t/2 multiplications (si t est la taille de l'exposant)
'''
'''
Ratio carré/multiplication : 9/11
'''
'''
Protocole de chiffrement utilisé par Alice pour son message :
La clé échangée est stockée dans un fichier (SecretKey.dat) :
'''
c1 = squareAndMultiply(g,k,p, keyLength)
c1 = c1%(2**256)
print('key = c1 =',hex(c1))
f = open('SecretKey.dat','w')
f.write(str(hex(c1)))
f.close()
'''
La commande de chiffrement utilisée par Alice est la suivante :
   openssl aes-256-cbc -e -in output.txt -out output.cph -pbkdf2 -pass file:SecretKey.dat


'''
